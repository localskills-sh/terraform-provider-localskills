---
page_title: "localskills_oidc_trust_policy Resource - terraform-provider-localskills"
subcategory: "Enterprise"
description: |-
  Configures an OIDC trust policy for CI/CD token exchange.
---

# localskills_oidc_trust_policy (Resource)

Manages an OIDC trust policy for a team on [localskills.sh](https://localskills.sh). OIDC trust policies enable CI/CD pipelines to authenticate with localskills.sh without storing long-lived API tokens.

The authentication flow works as follows: a CI/CD system (GitHub Actions or GitLab CI) issues an OIDC JWT during a pipeline run. The pipeline exchanges this JWT at the localskills.sh token exchange endpoint for a short-lived API token (valid for 1 hour). The trust policy defines which repositories, Git refs, and environments are authorized to perform this exchange.

The `ref_filter` attribute accepts glob patterns for matching Git references. For example, `refs/heads/main` restricts access to the main branch, while `refs/tags/*` allows any tag. The default value `*` matches all refs. The `environment_filter` attribute can restrict access to specific deployment environments (e.g., `production`).

The `skill_ids` attribute restricts which skills the exchanged token can access. When set to `null` (omitted), the token can access all skills owned by the team. Each team can have a maximum of 20 OIDC trust policies.

## Example Usage

```terraform
# Allow GitHub Actions from main branch to publish skills
resource "localskills_oidc_trust_policy" "github_deploy" {
  tenant_id    = localskills_team.engineering.id
  name         = "GitHub Deploy"
  oidc_provider     = "github"
  repository   = "myorg/skills-repo"
  ref_filter   = "refs/heads/main"
  skill_ids    = [localskills_skill.eslint_rules.id]
  enabled      = true
}

# Allow all branches for staging
resource "localskills_oidc_trust_policy" "github_staging" {
  tenant_id          = localskills_team.engineering.id
  name               = "GitHub Staging"
  oidc_provider           = "github"
  repository         = "myorg/skills-repo"
  ref_filter         = "*"
  environment_filter = "staging"
  enabled            = true
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `name` (String) The name of the OIDC trust policy.
- `oidc_provider` (String) The OIDC provider. Must be one of: github, gitlab.
- `repository` (String) The repository identifier (e.g., 'org/repo').
- `tenant_id` (String) The ID of the team (tenant) this policy belongs to.

### Optional

- `enabled` (Boolean) Whether the policy is enabled. Defaults to true.
- `environment_filter` (String) Environment filter for the policy.
- `ref_filter` (String) Git ref filter pattern. Defaults to '*' (all refs).
- `skill_ids` (List of String) List of skill IDs that this policy grants access to.

### Read-Only

- `created_at` (String) The timestamp when the policy was created.
- `created_by` (String) The user who created the policy.
- `id` (String) The unique identifier of the OIDC trust policy.
- `updated_at` (String) The timestamp when the policy was last updated.

## Import

Import an OIDC trust policy using the tenant ID and policy ID separated by a slash:

```sh
terraform import localskills_oidc_trust_policy.example <tenant_id>/<policy_id>
```
